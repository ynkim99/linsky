<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linksy Combined</title>
    
    <!-- 부트스트랩 아이콘 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- css 가저오는 곳 -->
	<!-- 메뉴바랑 css 합쳐서 하나만 가져옴 -->
    <link rel="stylesheet" href="/css/searchbar.css">
</head>
<body>
    <div class="page">
        <!-- 메뉴바 -->
        <div class="menu_bar">
            <div class="menubar_header"></div>
            <div class="logo_img">
                <img alt="Logo" src="/images/logo/blacklogo.png">
            </div>
            <div class="margin_logo2menu"></div>
            <div class="menu_content_container_list">
                <div class="menu_content_container">
                    <a href="#"> 
                        <div class="menu_icon_img">
                            <i class="bi bi-house-door"></i>
                        </div>
                        <div class="menu_content">홈</div>
                    </a>
                </div>
                <div class="menu_content_container">
                    <a href="#"> 
                        <div class="menu_icon_img">
                            <i class="bi bi-search"></i>
                        </div>
                        <div class="menu_content">검색</div>
                    </a>
                </div>
                <div class="menu_content_container">
                    <a href="#"> 
                        <div class="menu_icon_img">
                            <i class="bi bi-pencil"></i>
                        </div>
                        <div class="menu_content">작성</div>
                    </a>
                </div>
                <div class="menu_content_container">
                    <a href="#"> 
                        <div class="menu_icon_img">
                            <i class="bi bi-person"></i>
                        </div>
                        <div class="menu_content">프로필</div>
                    </a>
                </div>
                <div class="menu_content_container">
                    <a href="#"> 
                        <div class="menu_icon_img">
                            <i class="bi bi-bell"></i>
                        </div>
                        <div class="menu_content">알림</div>
                    </a>
                </div>
                <div class="menu_content_container">
                    <a href="#"> 
                        <div class="menu_icon_img">
                            <i class="bi bi-gear"></i>
                        </div>
                        <div class="menu_content">설정</div>
                    </a>
                </div>
                <div class="menu_content_container">
                    <a href="#"> 
                        <div class="menu_icon_img">
                            <i class="bi bi-question-circle"></i>
                        </div>
                        <div class="menu_content">Q & A</div>
                    </a>
                </div>
            </div>
            <div class="menu_bottom_margin"></div>
        </div>

        <!-- 메인 컨텐츠 -->
        <div class="search_page">
            <div class="header">
                <div class="search-container">
                    <form id="searchForm" class="search-form">
                        <input type="text" class="search-bar" name="keyword" placeholder="Search..." th:value="${keyword}">
                        <button class="search-button" type="button" onclick="submitSearch()">Search</button>
                    </form>
                </div>
            </div>
            <div class="content">
                <!-- 선택 탭 -->
                <div class="tabs">
                    <button class="tab-button" th:classappend="${activeTab == 'account'} ? 'active'" 
                            onclick="changeTab('/search/accounts')">Account</button>
                    <button class="tab-button" th:classappend="${activeTab == 'hashtag'} ? 'active'" 
                            onclick="changeTab('/search/hashtag')">Hashtag</button>
                    <button class="tab-button" th:classappend="${activeTab == 'feed'} ? 'active'" 
                            onclick="changeTab('/search/feed')">Feed</button>
                </div>

                <!-- 탭 내용물 -->
                <div class="tab-content">
                    <!-- Account 탭 -->
                    <div id="account" class="tab-panel" th:classappend="${activeTab == 'account'} ? 'active'">
                        <h2>Account Content</h2>
                        <ul th:if="${members != null}">
                            <li th:each="member : ${members}">
                                <img th:src="${member.userImg}" alt="Profile" width="50" height="50">
                                <span th:text="${member.userName}"></span>
                                <p th:text="${member.userIntroduce}"></p>
                            </li>
                        </ul>
                        <p th:if="${members != null and members.empty}">검색된 계정이 없습니다.</p>
                    </div>

                    <!-- Hashtag 탭 -->
                    <div id="hashtag" class="tab-panel" th:classappend="${activeTab == 'hashtag'} ? 'active'">
                        <h2>Hashtag Content</h2>
                        <div class="grid" th:if="${hashtagFeeds != null}">
                            <div class="grid-item" th:each="feed : ${hashtagFeeds}">
                                <img th:each="image : ${feed.images}" th:src="${image.imgName}" alt="Feed Image">
                                <p th:text="${feed.feedContent}">Feed Content</p>
                                <span th:text="${feed.feedTime}">Feed Time</span>
                                <span th:text="'Likes: ' + ${feed.likeAmount}">Likes</span>
                            </div>
                        </div>
                        <p th:if="${hashtagFeeds != null and hashtagFeeds.empty}">검색된 해시태그가 없습니다.</p>
                    </div>

                    <!-- Feed 탭 -->
                    <div id="feed" class="tab-panel" th:classappend="${activeTab == 'feed'} ? 'active'">
                        <h2>Feed Content</h2>
                        <div class="grid" th:if="${feeds != null}">
                            <div class="grid-item" th:each="feed : ${feeds}">
                                <img th:each="image : ${feed.images}" th:src="${image.imgName}" alt="Feed Image">
                                <p th:text="${feed.feedContent}">Feed Content</p>
                                <span th:text="${feed.feedTime}">Feed Time</span>
                                <span th:text="'Likes: ' + ${feed.likeAmount}">Likes</span>
                            </div>
                        </div>
                        <p th:if="${feeds != null and feeds.empty}">검색된 게시글이 없습니다.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
<script>
function submitSearch() {
    const keyword = document.querySelector('.search-bar').value;
    const activeTab = document.querySelector('.tab-button.active');
    let url = '/search/accounts'; // 기본값

    if (activeTab) {
        if (activeTab.textContent === 'Hashtag') {
            url = '/search/hashtag';
        } else if (activeTab.textContent === 'Feed') {
            url = '/search/feed';
        }
    }

    window.location.href = `${url}?keyword=${encodeURIComponent(keyword)}`;
}

function changeTab(url) {
    const keyword = document.querySelector('.search-bar').value;
    if (keyword) {
        window.location.href = `${url}?keyword=${encodeURIComponent(keyword)}`;
    } else {
        window.location.href = url;
    }
}

// 엔터키 처리
document.querySelector('.search-bar').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        e.preventDefault();
        submitSearch();
    }
});
</script>

</html>
